<!DOCTYPE html>
<html>
<head>

<title>Movie Recommendation</title>
<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
$(document).ready(function(){
	$("#middiv").hide();
	$("#collapse").hide();
	$("#aaa").hide();	
    $("#frmsubmit").click(function(){
        $("#middiv").show();
	$("#collapse").hide();
    });
    $("#nwusr").click(function(){
        $("#middiv").hide();
	$("#collapse").show();
	$("#aaa").show();
	$("#bbb").hide();
    });
    
    $("#ratemovies").click(function(){
        $("#middiv").hide();
	$("#collapse").show();
	$("#bbb").show();
	$("#aaa").hide();
    });
});

</script>

</head>
<body bgcolor=#e1f5fe>

	
  <div class="jumbotron text-center">
      <h1 align="center">Welcome to Movie Recommendation System</h1>	
  </div>
  <div style="background-color:#ddd; height:300px;width:50%;float:left;">
    <center>
	<h2>Movie Recommendation</h2>	
	</br></br>	
	<form action="">
      		<input id="m" autocomplete="off" placeholder="Enter your user ID"/>
		<button id="frmsubmit" class="btn btn-success">Submit</button>
		<button id="ratemovies" class="btn btn-info">Rate Movies</button><br><br><br>		
    	</form>	
		
		<button id="nwusr" href="#collapse" class="btn btn-primary">New User</button>		
    </center>		
  </div>

  <div style="background-color:#cba; height:300px;width:50%;float:right;">
	<center><h2>Top 10 Movie Statistics</h2></center>
    <div style="width:60%;float:right;">	
	<h4><a href = "" id="1">Number of rating per movie</a><br></br>
	<a href = "" id="2">Average rating per movie</a><br></br>
	<!--<a href = "" id="3">Movies with highest average rating</a><br></br>-->
	<a href = "" id="4">Highest average ratings with more than 500 reviews</a><br></br>
	<a href = "" id="5">Per genres highest rated movies</a><br></br></h4>
    </div>
  </div>

  <div id ="middiv" style="background-color:#e1f5fe;clear:both">
 
     <h2> <input id="mmsg" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe;font-size:24px;"></input></h2>
 
  </div>
  </div>
  <div style="background-color:#e1f5fe; height:450px;width:50%;float:left;">
	<label id="message"></label>		
		
		<div id="collapse">
		    <p>

			<h4 align="center"><font size="5">Please rate the following movies (1-5 (best), or 0 if not seen</font></h4>
			<form action="">
			<table border=1 align="center" class="table table-striped">
			  <tr>
			    <th>MovieID</th>
			    <th>Movies</th>
			    <th>Ratings</th>
			  </tr>
			  <tr>
			    <td><input id="mid1" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe;"/></td>
			    <td width="70%"><input id="txt1" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe; width: 100%;"/></td>
			    <td><input id="m1"/></td>    
			  </tr>
			  <tr>
			    <td><input id="mid2" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7;"/></td>
			    <td><input id="txt2" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7; width: 100%;"/></td>
			    <td><input id="m2"/> </td>   
			  </tr>
			  <tr>
			    <td><input id="mid3" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe;"/></td>
			    <td><input id="txt3" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe; width: 100%;"/></td>
			    <td><input id="m3"/> </td>   
			  </tr>
			  <tr>
			    <td><input id="mid4" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7;"/></td>
			    <td><input id="txt4" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7; width: 100%;"/></td>
			    <td><input id="m4"/> </td>    
			  </tr>
			  <tr>
			    <td><input id="mid5" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe;"/></td>
			    <td><input id="txt5" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe; width: 100%;"/></td>
			    <td><input id="m5"/> </td>    
			  </tr>
			  <tr>
			    <td><input id="mid6" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7;"/></td>
			    <td><input id="txt6" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7; width: 100%;"/></td>
			    <td><input id="m6"/> </td>
			  </tr>
			  <tr>
			    <td><input id="mid7" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe;"/></td>
			    <td><input id="txt7" STYLE="background-color: #e1f5fe; border: 2px solid #e1f5fe; width: 100%;"/></td>
			    <td><input id="m7"/> </td>
			  </tr>
			  <tr>
			    <td><input id="mid8" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7;"/></td>
			    <td><input id="txt8" STYLE="background-color: #FEFAF7; border: 2px solid #FEFAF7; width: 100%;"/></td>
			    <td><input id="m8"/> </td>
			  </tr>
			</table>
			    <div id="aaa"><h4 align="center"><button align="center" id="tblsubmit">Submit</button></h4></div>
				<div id="bbb"><h4 align="center"><button align="center" id="tblsubmit1">Submit</button></h4></div>
			</form>
			</p>
		</div>

  </div>

<div id="dvTable">
	</div>  
<div style="background-color:#e1f5fe; height:450px;width:50%;float:right;">	
	
	<ul id="messages"></ul>
	
  </div>
<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
      var socket = io();

	//Pallavi
	var table = $("<table />");
        table[0].border = "1";
	
	//Ganesh
/*  
    $('form').submit(function(){
	$('#message').empty();
	$('#messages').empty();	
	socket.emit('User ID', $('#m').val());
        $('#m').val('');
        return false;
      });

*/	//Pallavi
	$(document).ready(function() {	
	 $("a").click(function(event) {
                //alert("As you can see, the link no longer took you to jquery.com");
		$('#dvTable').empty();
		
		$('#message').empty();
                var href = $(this).attr('id');
		if(href == 1)
		{
			var row = $(table[0].insertRow(-1));
	 		var headerCell = $("<th />");
           		headerCell.html("Title");
            		row.append(headerCell);
	 		var headerCell = $("<th />");
           		headerCell.html("Count");
            		row.append(headerCell);
	 		var headerCell = $("<th />");
           		headerCell.html("Genres");
            		row.append(headerCell);
		}
		else if(href == 2 || href == 3 || href == 4 )
		{
			var row = $(table[0].insertRow(-1));
	 		var headerCell = $("<th />");
           		headerCell.html("Title");
            		row.append(headerCell);
	 		var headerCell = $("<th />");
           		headerCell.html("Average");
            		row.append(headerCell);
	 		var headerCell = $("<th />");
           		headerCell.html("Genres");
            		row.append(headerCell);
		}
		else if(href == 5)
		{
			var row = $(table[0].insertRow(-1));
	 		var headerCell = $("<th />");
           		headerCell.html("Title");
            		row.append(headerCell);
	 		var headerCell = $("<th />");
           		headerCell.html("Genres");
            		row.append(headerCell);
		}
	
                //alert(href);		
		socket.emit('chat message', href);
                event.preventDefault();
            });
	
	//Ganesh
	$("button").click(function(event) {
                //alert("As you can see, the link no longer took you to jquery.com");
		$('#messages').empty();
		$('#message').empty();
                var href = $(this).attr('id');
                //alert(href);

		if (href=="ratemovies")
		{
			$('#message').empty();
			$('#messages').empty();	
			socket.emit('showmovie', $('#m').val());			
			return false;
		}
		else if (href=="nwusr")
		{
			$('#message').empty();
			$('#messages').empty();	
			socket.emit('showtable',"Send Me Movies");			
			return false;
		}

		else if (href=="frmsubmit")
		{
			$('#message').empty();
			$('#messages').empty();	
			socket.emit('User ID', $('#m').val());
			$('#mmsg').val("Hi your user ID is : "+$('#m').val());
			$('#m').val('');			
			return false;
		}
		else if(href=="tblsubmit")
		{
			$('#message').empty();
			$('#messages').empty();
	socket.emit('userratings', $('#m1').val()+","+$('#m2').val()+","+$('#m3').val()+","+$('#m4').val()+","+$('#m5').val()+","+$('#m6').val()+","+$('#m7').val()+","+$('#m8').val());
        //$('#m1').val('');$('#m2').val('');$('#m3').val('');$('#m4').val('');$('#m5').val('');$('#m6').val('');$('#m7').val('');$('#m8').val('');
        return false;			
		}
		else if(href=="tblsubmit1")
		{
			$('#message').empty();
			$('#messages').empty();
	socket.emit('userratings1', $('#m1').val()+","+$('#m2').val()+","+$('#m3').val()+","+$('#m4').val()+","+$('#m5').val()+","+$('#m6').val()+","+$('#m7').val()+","+$('#m8').val());
        //$('#m1').val('');$('#m2').val('');$('#m3').val('');$('#m4').val('');$('#m5').val('');$('#m6').val('');$('#m7').val('');$('#m8').val('');
        return false;			
		}
		socket.emit('chat message', href);
                event.preventDefault();
            });	

 	});
	
	//Ganesh
	socket.on('showtable', function(msg){
		var output=msg.split("@");
		var i=1;
		var j=1;
		while(i<output.length){
			$('#mid'+j).val(output[i]);			
			$('#txt'+j).val(output[i+1]);
			i=i+2;
			j=j+1;
		}
      	});

	socket.on('showmovie', function(msg){
		var output=msg.split("@");
		//if(output.length>1)
		//console.log(output);
		//var output1=output.split("@");
		//if(output1.length>1)
		//console.log(output1[1]);		
		var i=1;
		var j=1;
		while(i<output.length){
			$('#mid'+j).val(output[i]);			
			$('#txt'+j).val(output[i+1]);
			i=i+2;
			j=j+1;
		}
      	});
      
      socket.on('User ID', function(msg){
        $('#message').append($('<li>').text(msg));
      });
	
	socket.on('userratings', function(msg){
        $('#message').append($('<li>').text(msg));
      });

	socket.on('userratings1', function(msg){
        $('#message').append($('<li>').text(msg));
      });

	//Pallavi
	socket.on('data', function(msg){
	console.log(msg)
	 row = $(table[0].insertRow(-1));
	  var arr = msg.split(",")
	     for (var j = 0; j < arr.length; j++) {
             var cell = $("<td />");
		//console.log(arr[j])
                cell.html(arr[j]);
                row.append(cell);
	}	 
	
	var dvTable = $("#dvTable");
       // dvTable.html("");
        dvTable.append(table);	
      // $('#messages').append($('<li>').text(msg)); 
	
      });
    </script>
</body>
</html>
